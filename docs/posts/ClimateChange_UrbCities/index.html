<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Irene Chesang">
<meta name="dcterms.date" content="2024-05-08">

<title>SpatialInsights - Climate Change Resilience in Urban Planning: Adaptation Strategies for Kenyan Cities</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">SpatialInsights</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blogz.html"> 
<span class="menu-text">Blogs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contz.html"> 
<span class="menu-text">Contacts</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://facebook.com/BenAmollo"> <i class="bi bi-facebook" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Plan_Ben_Amollo"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://instagram.com/Ben.Amollo"> <i class="bi bi-instagram" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://whatsapp.com/+254721646495"> <i class="bi bi-whatsapp" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KampSpatial"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/BenAmollo"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Climate Change Resilience in Urban Planning: Adaptation Strategies for Kenyan Cities</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Climate Change</div>
                <div class="quarto-category">Urban</div>
                <div class="quarto-category">Disaster</div>
                <div class="quarto-category">Land Use</div>
                <div class="quarto-category">Planning</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Irene Chesang </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 8, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="section" class="level1">
<h1></h1>
</section>
<section id="abstract" class="level1">
<h1>Abstract</h1>
<p>Climate change presents a significant and multifaceted threat to the well-being and prosperity of Kenyan cities. Rising temperatures, erratic rainfall patterns, extreme weather events, and rising sea levels pose immense challenges to urban infrastructure, water security, public health, and overall sustainability. This paper delves into the concept of climate change resilience in urban planning for Kenyan cities, emphasizing the critical need for proactive adaptation strategies. It explores the inherent vulnerabilities of urban areas, particularly informal settlements, and underscores the importance of integrating climate considerations into urban planning frameworks. Based on the relevant literature and peer reviewed articles including drawing on detailed case studies from Nairobi and other Kenyan cities, the paper discusses key adaptation strategies such as green infrastructure, improved drainage systems, nature-based solutions, and community-based adaptation initiatives. It further highlights the crucial role of robust governance, financial resources, and community engagement in ensuring the successful implementation of these strategies.</p>
</section>
<section id="introduction." class="level1">
<h1>Introduction.</h1>
<p>Urbanization in Kenya is rapidly transforming the landscape, with cities like Nairobi experiencing exponential population growth. However, this growth occurs against the backdrop of a rapidly changing climate, posing significant challenges for urban planning and development. Climate change is projected to exacerbate existing vulnerabilities in Kenyan cities, leading to:</p>
<p><strong>i. Increased frequency and intensity of extreme weather events</strong></p>
<p>According to Lwasa in his article “Adapting urban areas in Africa to climate change” Floods, droughts, heatwaves, and storms are expected to become more frequent and severe, causing widespread damage to infrastructure, livelihoods, and human life (Lwasa, 2010).</p>
<p><strong>ii. Water scarcity</strong></p>
<p>This will be due toerratic rainfall patterns and rising temperatures will likely lead to water shortages, jeopardizing access to clean drinking water and sanitation for urban populations.</p>
<p><strong>iii. Sea-level rise</strong></p>
<p>Coastal cities like Mombasa face the threat of inundation and salinization of freshwater sources due to rising sea levels, posing significant risks to coastal communities and infrastructure (Leal Filho et al., 2019).</p>
<p><strong>iv. Increased health risks</strong></p>
<p>&nbsp;The spread of vector-borne diseases such as malaria and dengue fever is expected to worsen due to warmer temperatures and increased flooding (Baker, 2012).</p>
<p>These challenges disproportionately impact vulnerable populations, particularly those residing in informal settlements with limited access to basic services, infrastructure, and financial resources. Building climate resilience in Kenyan cities requires a proactive and multi-pronged approach that integrates adaptation strategies into urban planning frameworks.</p>
<p><img src="images/67d30fa866af4fb99641d4de63623532.png~tplv-6bxrjdptv7-image.png" class="img-fluid"></p>
</section>
<section id="understanding-urban-vulnerabilities" class="level1">
<h1>Understanding Urban Vulnerabilities</h1>
<p>Informal settlements are particularly susceptible to climate change impacts due several &nbsp;factors such as</p>
<p><strong>a) Location</strong></p>
<p>These settlements are often situated in floodplains, low-lying areas, or on steep slopes, making them highly vulnerable to flooding, landslides, and other hazards.</p>
<p><strong>b) Poor infrastructure</strong></p>
<p>Lack of proper drainage systems, sanitation facilities, and flood defenses heightens vulnerability during extreme weather events (Wanjohi, 2018).</p>
<p><strong>c) Limited access to resources</strong></p>
<p>&nbsp;Residents often lack the financial means to invest in adaptation measures or relocate to safer areas, further exacerbating their vulnerability (Chirisa et al., 2016).</p>
<p>Case studies like Mathare Valley in Nairobi illustrate the devastating consequences of inadequate infrastructure during extreme weather events. Floods regularly cause loss of life, damage property, and disrupt livelihoods thus highlighting the urgent need for targeted adaptation strategies in these vulnerable communities (Baker, 2012).</p>
<p><img src="images/343822c0375e4ae39e0040eb436f2489.png~tplv-6bxrjdptv7-image (1).png" class="img-fluid"></p>
</section>
<section id="adaptation-strategies-for-kenyan-cities" class="level1">
<h1>Adaptation Strategies for Kenyan Cities</h1>
<p>Several key adaptation strategies can be implemented to enhance the resilience of Kenyan cities</p>
<p><strong>1) Green infrastructure</strong></p>
<p>&nbsp;This involves utilizing green spaces, parks, bioswales, and rain gardens can significantly improve stormwater management, reduce flooding risks, and enhance urban air quality. Nairobi’s “Komb Green Solutions” project serves as a prime example, demonstrating the effectiveness of green infrastructure in creating multifunctional spaces that address both environmental and social needs (Frontiers, 2022).</p>
<p><strong>2) Improved drainage systems</strong></p>
<p>This could be achieved by upgrading drainage infrastructure to handle increased precipitation and prevent flooding, especially in flood-prone areas, is crucial for protecting communities and infrastructure.</p>
<p><strong>3) Climate-proofing critical infrastructure</strong></p>
<p>This would involve protecting essential infrastructure like water supply systems, transportation networks, and healthcare facilities from climate hazards is vital for ensuring the continued functioning of vital services during extreme events.</p>
<p><strong>4) Nature-based solutions</strong></p>
<p>This can be achieved by utilizing mangroves, coastal vegetation, and coral reefs can buffer against sea-level rise and storm surges in coastal cities like Mombasa. These natural defenses provide cost-effective and sustainable solutions for protecting coastal communities and infrastructure.</p>
<p><strong>5) Early warning systems</strong></p>
<p>This can be realized by Implementing effective early warning systems to alert communities about impending weather events and facilitate timely evacuation is crucial for minimizing loss of life and property damage.</p>
<p><strong>6) Community-based adaptation</strong></p>
<p>This would involve engaging local communities in identifying vulnerabilities, developing adaptation plans, and implementing low-cost solutions is essential for ensuring effective and sustainable adaptation strategies. Initiatives like Mombasa’s Participatory Climate Change Adaptation Appraisal (PCCAA) demonstrate the power of community-based approaches (Moser &amp; Stein, 2011).</p>
<p><img src="images/c2b41596cb0149c286e8ab979a68751b.png~tplv-6bxrjdptv7-image.png" class="img-fluid"></p>
</section>
<section id="the-role-of-urban-planning-in-building-resilience" class="level1">
<h1>The Role of Urban Planning in Building Resilience</h1>
<p>Urban planning plays a critical role in building climate resilience by:</p>
<p>i. Conducting comprehensive vulnerability assessments byIdentifying areas and populations most at risk from climate change impacts is crucial for prioritizing adaptation efforts and allocating resources effectively.</p>
<p>ii. Integrating climate considerations into planning frameworks for instanceSpatial plans should prioritize green infrastructure, flood defenses, and climate-resilient development patterns to ensure long-term sustainability and minimize future risks (Cobbinah, 2021).</p>
<p>iii. Promoting inclusive and participatory planning throughensuring that the voices and needs of vulnerable communities are incorporated into decision-making processes is essential for developing equitable and effective adaptation strategies (Bulkeley &amp; Tuts, 2013).</p>
<section id="challenges-and-opportunities" class="level2">
<h2 class="anchored" data-anchor-id="challenges-and-opportunities">Challenges and Opportunities</h2>
<p>Implementing successful adaptation strategies requires overcoming several significant challenges:</p>
<p><strong>a) Limited financial resources</strong></p>
<p>&nbsp;Kenyan cities often lack the necessary financial resources to invest in large-scale adaptation projects, hindering the implementation of critical infrastructure upgrades and green infrastructure initiatives.</p>
<p><strong>b) Institutional capacity constraints</strong></p>
<p>Strengthening institutional capacity within government agencies is crucial for effective planning, implementation, and monitoring of adaptation measures. This requires training and capacity building for relevant personnel to ensure effective management of climate change adaptation initiatives.</p>
<p><strong>c) Social and political barriers</strong></p>
<p>&nbsp;Addressing competing priorities, ensuring equitable access to resources, and navigating political complexities can hinder progress towards achieving comprehensive and inclusive climate adaptation goals.</p>
<p>Despite these challenges, opportunities exist to leverage existing strengths and build resilience:</p>
<p><strong>i. Existing community initiatives</strong>&nbsp;</p>
<p>By building upon the knowledge and resourcefulness of communities already engaged in adaptation efforts can provide valuable insights and contribute to the development of locally relevant solutions (Kithiia, 2009).</p>
<p><strong>ii. International collaboration</strong></p>
<p>This involvesaccessing technical expertise, financial support, and knowledge-sharing opportunities through international partnerships can significantly enhance the capacity of Kenyan cities to implement effective adaptation strategies.</p>
<p><strong>iii. Mainstreaming climate change into development policies</strong></p>
<p>This involvesintegrating climate resilience into national and local development plans ensures a comprehensive and coordinated approach to addressing climate change challenges across various sectors. This requires strong political commitment and a clear vision for a climate-resilient future (Oyugi, 2023).</p>
</section>
</section>
<section id="case-studies" class="level1">
<h1>Case Studies</h1>
<p>Nairobi, the capital city of Kenya, provides a microcosm of the challenges and opportunities faced by Kenyan cities in building climate resilience. The city experiences frequent flooding, water scarcity, and heatwaves, disproportionately impacting vulnerable populations residing in informal settlements. However, Nairobi has also undertaken several initiatives to address these challenges, including:</p>
<p><strong>1) Green infrastructure projects</strong></p>
<p>&nbsp;The “Komb Green Solutions” project, mentioned earlier, is a prime example. Additionally, the Nairobi River Basin Management Authority is working to restore the Nairobi River and its riparian zones, creating green spaces that manage storm water runoff and improve urban ecology.</p>
<p><strong>2) Improved drainage systems</strong></p>
<p>&nbsp;The Nairobi Metropolitan Services has initiated projects to upgrade drainage infrastructure in flood-prone areas, aiming to reduce flooding risks and protect communities.</p>
<p><strong>3) Community-based adaptation</strong></p>
<p>Some organizations like the Mazingira Institute are working with communities in informal settlements to raise awareness about climate change risks, develop local adaptation plans, and implement low-cost solutions like rainwater harvesting and flood early warning systems.</p>
<p>Beyond Nairobi, cities like Mombasa are actively pursuing adaptation strategies specific to their coastal vulnerabilities. The Mombasa Action Plan on Climate Change outlines a comprehensive approach that includes:</p>
<p>a) Nature-based solutions which involvesUtilizing mangroves and coral reefs for coastal protection against sea-level rise and storm surges.</p>
<p>b) Improved sanitation and waste management byaddressing pollution and reducing the risk of waterborne diseases exacerbated by climate change.</p>
<p>c) Strengthening social safety nets by&nbsp;supporting vulnerable communities and ensuring their access to essential services during and after climate-related disasters.</p>
<p>These case studies highlight the importance of tailoring adaptation strategies to the specific vulnerabilities of each city while drawing inspiration and knowledge from successful initiatives implemented elsewhere.</p>
<p><img src="images/d402fb477b0f41ada4ec229ee9c8a281.png~tplv-6bxrjdptv7-image.png" class="img-fluid"></p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Building climate resilience in Kenyan cities requires a multifaceted approach that combines strategic urban planning, targeted adaptation strategies, and robust governance. Prioritizing green infrastructure, improving drainage systems, and empowering communities are crucial steps towards safeguarding vulnerable populations and ensuring the long-term sustainability of Kenyan cities in the face of climate change. By acknowledging the challenges and capitalizing on existing opportunities, Kenyan cities can build a more robust and equitable urban environment that is prepared to withstand the challenges posed by a changing climate.</p>
</section>
<section id="recommendations" class="level1">
<h1>Recommendations</h1>
<p>i. Conduct comprehensive vulnerability assessments by&nbsp;Identifying specific climate risks and tailor adaptation strategies accordingly.</p>
<p>ii. Develop and implement integrated climate action plans so as to&nbsp;prioritize green infrastructure, improved drainage systems, and nature-based solutions within urban planning frameworks.</p>
<p>iii. Strengthen institutional capacity in order toinvest in training and capacity building for government officials and stakeholders involved in climate adaptation initiatives.</p>
<p>iv. Secure adequate financial resources by&nbsp;exploring innovative financing mechanisms, such as public-private partnerships and international climate funds, to support adaptation projects.</p>
<p>v. Foster community engagement byactively involve local communities in decision-making processes, knowledge sharing, and implementation of adaptation strategies. This ensures that solutions are culturally relevant, address specific needs, and promote community ownership.</p>
<p>vi. Promote research and innovation byEncouraging research into climate-resilient technologies and adaptation strategies suitable for the Kenyan context. This can provide valuable insights for developing effective and cost-efficient solutions.</p>
<p>vii. Build partnerships and networks byCollaborating with national and international organizations to share best practices, access technical expertise, and leverage collective resources. This fosters knowledge exchange and strengthens the capacity for climate action across different scales.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>Baker, J. (2012). The impact of climate change on human health in Africa. Transactions of the Royal Society of Tropical Medicine and Hygiene, 106(10), 640-652.</p>
<p>Bulkeley, H., &amp; Tuts, R. (2013). Equity and justice in climate change adaptation: Letting down the vulnerable. Regional Environmental Change, 13(4), 831-840.</p>
<p>Chirisa, I., Mutengu, K., &amp; Mavhunga, P. (2016). Climate change vulnerability and adaptation in informal settlements in Africa: A case study of Harare, Zimbabwe. Journal of Environmental Planning and Management, 59(12), 2055-2077</p>
<p>Cobbinah, P. B. (2021). Integrating climate change adaptation into urban planning in Africa: A review of approaches, challenges, and opportunities. Sustainability, 13(18), 10306. <a href="https://doi.org/10.3390/su131810306"><u>https://doi.org/10.3390/su131810306</u></a></p>
<p>Frontiers. (2022, April 22). Komb Green Solutions: A people’s park for a climate-resilient Nairobi. frontiersin.org. Retrieved October 27, 2023, from</p>
<p>Kithiia, J. M. (2009). Community-based adaptation to climate change: A case study of nine villages in semi-arid Kenya. Environmental Management, 44(1), 209-225.</p>
<p>Leal Filho, W., Nalbantis, D., &amp; Filho, W. L. (2019). Vulnerability of coastal communities to climate change in Africa: A review. Mitigation and Adaptation Strategies for Global Change, 24(1), 7-32.</p>
<p>Lwasa, S. (2010). Vulnerability to climate change in African cities: A case study of Dar es Salaam, Tanzania. Current Opinion in Environmental Sustainability, 2(1), 16-25. <a href="https://doi.org/10.1016/j.cosust.2010.02.002"><u>https://doi.org/10.1016/j.cosust.2010.02.002</u></a></p>
<p>Moser, C., &amp; Stein, A. (2011). The social aspects of vulnerability to climate change: A scoping report. Tyndall Centre for Climate Change Research, University of East Anglia.</p>
<p>Oyugi, A. (2023). Mainstreaming climate change into development policy in Kenya: A review of progress and challenges. Climate Policy, 23(4), 505-522.</p>
<p>Wanjohi, G. (2018). Urbanization and climate change in Africa: Challenges and opportunities for adaptation. Planning for Climate Change, 1-22.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>